using System;
using System.IO;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Collections;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Collections.Frozen;
using System.Threading.Tasks;
using System.Diagnostics;

const string INPUT1 = @"#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#";

const string INPUT2 = @".####..
###..#.
..#.###
#.####.
#.####.
..#.###
###..#.
.####..
.....#.
...#.#.
.####..
###..#.
..#.###

.##...##..#
....#####.#
#..#.####.#
....##...##
.##.#......
####.###.##
.##.....###
#..###...##
#..#.#...#.
.##.######.
.##..###..#
#..##.#..#.
#..##.#..#.
.##..###..#
.##.######.
#..#.##..#.
#..###...##

........#.##.
.##..##.#####
#..##..#..#..
.........#.#.
...........##
###..####.###
........##..#
.##..##.#####
........##...
########...##
.##..##.#.###

###.#.########.#.
.#..#..##..##..#.
.#..#..##..##..#.
###.#.########.#.
#....#..####..#..
.########..######
..#.....#..#.....
##....##....##...
#...###...#..###.
..##.###.##.###.#
.###....#..#....#
###.#.#..##..#.#.
#..#.....##.....#

..##.###..###.##.
##..#..#..#..#..#
###..#..##..#.###
##..##########..#
###.####..####.##
..#...#.##.#...#.
##..#.#....#.#..#
..#.##.####.##.#.
..##.########.##.

.#.###.....###.
#.###########.#
#..####.##.#.#.
####...#.##.##.
####..##.##.##.
....#..####.###
.##..#...#...##
###...#..####..
###...#..####..
.##..#...#...##
....#..####.###
####..##.##.##.
####...#.##.##.

..#.#...#..##.##.
..#.#...#..##.##.
...##.#.###.#.#.#
##.##....#####.#.
##.#####.....#..#
....#..##.##.##.#
.##..#.#...#####.
..#.####.#..###.#
###..###.##..#.#.

##......#
####..###
...#..#..
###.##.##
..#....#.
....##.#.
..##..##.
....##...
###....##

#..##........##..
.##.##.####.##.##
.###.##.##.##.###
#..#.##.##.##.#..
###...#.##.#...##
#..###..##..###..
#..###.#..#.###..
#....########....
#..#.##.##.##.#..
####.#..##..#.###
###..#.#..#.#..##
.##.##......##.##
.#...#......#...#

.#.#.#.#.##.#
##.###.######
.#..#.##.##.#
##..##.##..##
#.#..#.......
..#.#....##..
...#.##.####.
##.###.######
######.###.##
.###.##.####.
.###.#...##..
#....##.#..#.
.###.##......
##.##.#......
##.##.#......

###.#....####
###......####
.##..##...###
.###..##.#...
...#.......##
######....#..
#....####.#..

.##..#####.
#..#####.##
.##...###.#
.##....####
....##...##
....##...#.
.##....####
.##...###.#
#..#####.##
.##..#####.
.....##.###

##....##.####
#..##..##.##.
#......##.##.
#.#..#.#.####
##.##.###....
...##....####
#.####.##....
#.#..#.######
##....##.#..#
##....##.####
.######......
##.##.####..#
.#.##.###....
.#....#.#....
###..####.##.

#.##.#..##.
#.##.##.##.
#######.###
..##...##..
##..###.#..
#....#...#.
.#..#.#..#.
#....##.#..
##..###.##.
######..#..
..##..#..##

.#..#..
..#....
##.....
...#.##
..#..##
.##..##
...#.##
##.....
..#....

.##..........##.#
##.#..####..#.##.
.##...####...#..#
#..............#.
.##..######..##..
################.
.####......####..
.....##..##.....#
.#.##.####.##.#..
.#.##.####.##.#..
.....##..##.....#
.####......####..
################.
.##..######..##..
#..............#.

#....#...#.####.#
.#..#...#...##...
#######.###.##.##
######...##.##.##
.####..##........
......#..#..##..#
.#..#...#.#....#.
##..###..###..###
..##....##.####.#
#.....####.#..#.#
##..##.#.#......#
#.##.#.###......#
#.##.#.#...#..#..

#..#.##.#.##.#.
##.....#......#
#..#..##..##..#
####.#..##..##.
####.#..##..##.
#..##.##..##..#
##.....#......#
#..#.##.#.##.#.
###.##..#....#.
.#.#..##.####.#
..##..#..#..#..
#.##...##.##.##
##..#.##.####.#
.#.##....#..#..
#####.###.##.##

##.##....
#.####.##
..##..##.
..#.#.#..
..#.#.#..
..##..##.
#.####.##
##.##....
....#.##.
###.####.
.#....###
##.#...##
##.##..##

....##.##..
####..#..#.
.....####..
....#.###..
#####.##.##
.....#..#..
#..##...#..
.....##.###
....##...#.
....#...#.#
####.##.###
.....###.##
......#..#.
####.##..#.
#####..####

.#.####..
###....#.
.#####..#
.##.##.##
##...##.#
#..#..#.#
##.#...#.
.#...#..#
.#...#..#
##.#...#.
#..#..#.#
##...##.#
.##.##.##
.#####..#
###....#.
.#.####.#
.#.####.#

###...###.##...
....##....#.#..
.##.##....#..##
.##.##....#..##
....##....#.#..
###...##..##...
...#.##..#..#..
###.#.#####....
#.#####.###..##
.#.#.....#.##..
.#.#.#.#.####..
##...#...#.#.##
#.##.....##..##

..###....
##.....#.
##.#..###
##..###..
...###...
#######.#
#######.#
...###...
##..###..
##.#..###
###....#.
..###....
..##.#.#.
#####...#
...#..#.#
###....#.
####.#.#.

#....##.####..#
#.##.#.#..##..#
##..###..###..#
.#..#...#..####
#....#..##..#..
..##..##.#.####
..##...#####..#
##..#######.##.
.####...##.####
.......#..#.##.
.####.#####.##.
.####...##.####
#.##.#.###.....

###.#.###.#.#.###
.#.........####.#
...#.#####.#.####
###.....##.##...#
#.######...##.#.#
.#.#.#.......##..
.#.#.#.......##..
#.######...##.#.#
###.....##.##...#
...#.#####.#.####
.#....#....####.#
###.#.###.#.#.###
###.#.###.#.#.###

.##....######.###
.##....######.###
####....#.#.#....
######.##...###.#
.##....###.##....
#######.###.###.#
.##.#.#.#.##.....
.#...##.###.###..
#..#.#.###..##..#
......#####..##.#
#..##..###.#..###
#####.#...###.###
####....#.##..###

#####...##...##
##.###..##..###
###..##....##.#
######.####.###
##..###.##.###.
.......#..#....
##.###.#..#.###

#..####..##.#####
#..####..##....#.
#..####..#.......
.##.##.##.....##.
....##......##.##
...#..#....##.#.#
.##.##.##.#.##.##
....##....#.#.#.#
####..#####.....#
.##.##.##.#.###..
..........##..###
#..#..#..##...#..
....##....#...#..

#.###.......#..#.
.#.#.#..#####..##
.#.###.##.#......
##..#.#...##.##.#
###..##.#..#....#
#.##....###......
##...######..##..
.##.#.#..###.##.#
#...#.#####.#..#.
.##..######..##..
..#..######..##..

..####..#
..##.####
##....##.
..#...##.
###.#...#
##.###..#
..#...##.

..#######.#######
..#....#..#.#.###
.#..#....####.###
.#..#....####.###
..#....#..#.#.###
..#######.#######
..##..#.#.#####..
.##.#.###.##.....
.###..#.#.#######
##..#..###.#.####
#..##.#..##.###..
....#.#.#..#.####
.#..#.....##..##.
##..##.###..#..##
..#..#.####.##.##
#..#.#.###.#.##..
...###.##..##....

###....#.
..####.##
###.#..##
..#.###.#
..#.###.#
###.#..##
..##.#.##
###....#.
##.#####.
##..###.#
..#.###.#
##....###
...#..##.

#..###...#.##..
..#####.#..#.##
...######.##.##
#.##...#.##.###
..#...#.#...###
.#.#...#...##..
.#.#....####...
####..##.#..###
####..####..###

.###.####..
.###.####..
..##.#.##.#
..#.#..###.
#.##.####.#
#...###.##.
...######..
..#...####.
###...#....
###...#....
..##..####.
...######..
#...###.##.
#.##.####.#
..#.#..###.
..##.#.##.#
.###.####..

#.###..####..####
####.###.#......#
.#.#...#...#....#
...#.##.#.##..#..
##...#.#.##.##.#.
##...#.#.##.##.#.
...#.##.#.##..##.
.##.###.#.#..##.#
.##.###.#.#..##.#
...#.##.#.##..##.
##...#.#.##.##.#.
##...#.#.##.##.#.
...#.##.#.##..#..

######...#.
.####.#.###
.####.###.#
.####.###.#
.####.#.###
######...#.
#....#.####
.####.....#
#....##.##.
#######..##
##..##...##
.####..####
######.##.#
#.##.#.##..
#.##..#####

##..#...#..
#.##.##..#.
..#.##..#.#
..#.##..#.#
#.##.##..#.
##..#...#..
#....##..##
....####...
..#.####...

......#.###...#
##..###.##..#.#
#.##.#...#.###.
#.##.#.#.#.###.
##..###.##..#.#
......#.###...#
##..##.#####.#.
######.##.####.
.#..#......##..

.#.###.##..##.###
#..###..####..###
###..###....###..
..##.###....###.#
##.#....####....#
##.#.###.##.###.#
.###.#..####..#.#
..###...####...##
#...#.########.#.
#....#..####..#..
####............#
####............#
.....#..####..#..

##.####.###
#......####
#......####
##.####.###
##..#...#..
.#.......#.
.#....####.
#.##.##..##
##..###...#
####..#....
...##..##.#
...#.######
...#.#####.

##.###.
...##.#
...##.#
######.
....##.
##.....
..###.#
##.###.
..#.###
..##.#.
...####

.##########..##
.#.#....#.###..
##...##...###.#
#.########.#...
..###..###..##.
.#.##..##.#.###
.#.##..##.#.###

##.#####..#
..#...#####
.#..#......
#...##..##.
.##....#..#
###.#.#....
##..#.#.##.
#.#########
#.###.#####

##.###.
.##..##
.##..##
##.###.
#.#....
.#...##
##.###.
#.#.###
#.#..##
##.###.
.#...##
#.#....
##.###.

.......###.##...#
#.###.#.##...#.##
#.###.#.##...#.##
.#.....###.##...#
##.#.#.##.##..#.#
#.#..#.....####.#
......#.#....##..
#..##.###...#..##
##.###......##...
##.###......##...
#..##.###...#..##
......#.#....##..
#.#..#.....####.#

#......##
##.#.....
##.#.....
#.#....##
..#######
#.###.###
#..######

#....#.##
######.##
##..##.#.
.#..#..##
..##.....
.......##
######.#.
.#..#.###
.#..#.##.

##.#...##
###.###..
.##.#..#.
.#.#.##.#
#..#..###
#.###.#.#
#.###.#.#
#..#..###
.#.#.##.#
.##....#.
###.###..
##.#...##
##.#...##
###.###..
.##....#.

#.##..##.##.#.#
....##.....#.#.
....##.....##..
....##.....##..
....##.....#.#.
#.##..##.##.#.#
#.##..##...###.
..#....#..#....
#...##...#..##.
...#..#....#...
.##.##.##.#..##
#.#....#.#.#.#.
..#....#..##.#.

..#####
..###..
.####..
.#..###
#..#...
#..#...
....###
.####..
..###..
..#####
..#.###
...#...
.##..##

#...####.######.#
#...####.######.#
#..#....##....##.
######.##.#..#.##
..#.#....#....#..
##.##.##.#.##.#.#
.####.#.########.
####...#...##...#
....##..########.
........#..##..#.
#.#..###.######.#
......#.#..##..#.
#.##..##..##.#..#

#.####.....##..
#.####.....##..
#.######......#
....####.#.#...
##.#....##..#.#
#...###..##..#.
#.#.#..####.#.#
##.#####.##.###
##.#####.##.###
#.#.#..####.#.#
#...###..##..#.
##.#....##..#.#
....####.#.#...
#..#####......#
#.####.....##..

#..##.##.##
#..##.##.##
.##.#....##
.#.##.#....
.###..##..#
#...#.#..##
.#..#....#.
##.#..##.#.
#.#.#...###
#.####....#
.#.###..#.#
.###..#####
.###..#####
.#.###..#.#
#.####....#
#...#...###
##.#..##.#.

####...#.####.#
.##.####...#..#
.##..##.#.#..#.
....##.#.....#.
###..#......##.
.......###.#.#.
####..#.#.##..#
#..#.##.#..####
#..#.##.#..####
####..#.#.##..#
.......###.#.#.

.#....#....
.######..##
.#.##.#..##
.#....#....
...##...##.
#..##..#.##
.##..##.###

#######.#
#.###....
###.#.#.#
....####.
.#.#..###
#..##.###
#..##.###
.#.#..###
....####.
###.#.#.#
#.###...#
#######.#
.##.#...#
.##.#...#
#######.#

##.##.#....##
.##.###.###.#
.######.###.#
##.##.#....##
.##..#..#...#
#...#...#....
#....#.....#.
###.#.##.####
....#..####..
#...#...#....
....####.#...
....####.#...
#...#...#....
....#..####..
###.#.##.####

#.##.##..##.#
.#..#......#.
#....######..
..##..#..#..#
######.##.###
..##...##...#
#.##.######.#
.###..####..#
#....#....#..
.#..#.#..#.#.
.####.####.##
.#..#.#..#.#.
......####...
.#..#.####.#.
.#..#.#..#.#.
#....#.##.#..
##..##.##.##.

####.#..#.#####
.#.#.#..#.#.#..
.###.####.##..#
..#........#..#
##.##....##.###
##.##....##.###
..#........#..#

######..#####
##..######..#
#..#.#..#.#..
..####..####.
..##..##..##.
..##......##.
...########..

#.#####..
#.#####..
...####..
...#..#..
.###..###
###.##.##
..#.##.#.

##.##....
##.##....
.###.#.##
##.####..
###..####
####...##
#..##..##
#.#######
#.#...#..
.#....#..
###..#...
#.##..#..
........#
......###
...#.....
######...
...#.....

.###..###..##..
..######....###
..######....###
.###..###..##..
..#.##.#..####.
..#....#....##.
..######......#
...####.....###
..#.##.#..#....
..#....##....#.
.#......#.##...
..........#####
###.##.###.....

.#..#.##.###.
.#..#..###.#.
..##..#...#.#
##..######...
#....#..#..##
.........###.
#######..#.#.
#########..#.
......##.....
########.####
.####.##..#..
..##..######.
..##...#...##
..##...#...##
..##..##.###.

.#.#.##
#.###..
....###
.#.#.##
#...###
.##....
.##....
#...###
...#.##

#..###.###..#..
...######..#.#.
...######..#.#.
#..###.###..#..
###..#..#.#..##
..##.##.##.#..#
######..#..###.
......#...##..#
###..####....#.
###..####....#.
......#...##..#
######.##..###.
..##.##.##.#..#

...#..#######
..#.#.....#.#
....#..#..#..
...#######.##
##.##..#.##..
##.#.#..#.#..
##.#.##..#.##
##.###...##..
.....#.######
..#.#......##
##..#.#...###

#......##
..####...
#.####.##
#..##..##
#..##..##
...##....
.######..
..####...
.##..##..
##....###
..##.#...

.#.#..#.#
#...##...
#....#...
#......##
###.####.
##..#.##.
####..###
#.##..###
##..#.##.
###.####.
#......##
#....#...
#...##...
.#.#..#.#
....##.##
.#.###.##
.#.###.##

..##.#..#
####.#..#
##...####
##.#.....
###.#####
..#...##.
###...##.
...#..##.
###.#####
##.##.##.
...#.....
####.####
######..#
####.#..#
..#..#..#
####.....
##.###.##

......#.#
####.#.##
.....####
....##.#.
.....#.##
....##.#.
####....#
#..##.#.#
#######.#
....#.##.
######...

#.#####..###..#
##...####.#.##.
#.#.##.##....#.
#.#.##.##....#.
##...####.#.##.
#.#####..###..#
#.#.#.#.#.#.#.#
##..##.####.###
.####.####.#..#
#####..########
#####..###.####
.####.####.#..#
##..##.####.###

...##.##.#...#...
......#####.###..
.#...##.###......
###.#.#.##.#..###
..##....#...#####
..##....#...#####
###.#.#.##.#..###
.#...##.#.#......
......#####.###..
...##.##.#...#...
#.###..#.#..###..

..####..#..#..#
##.###..#.###..
##.#..#...#..##
##.#..#...#..##
##.###..#.###..
.#####..#..#..#
.#...##.###..##
#..###.##..#.##
...#.##.#.#.#..
..####..#.####.
..#......#....#
#..#..##..##.#.
.##.....#.#.#..
.##.....#.#.#..
#..#..##..##.#.
..#......#....#
..####..#.####.

###########..#...
##..##..###..####
....##....##.....
..#.##.#...##.###
............##...
#.######.##..#...
...####....##..##
#..####..#.######
..######..#....##
##......##..###..
..##..##..#######
.###..###.#......
###########.##...
..#.##.#..#.##.##
#........#####.##
#.#.##.#.######.#
....##....#######

.#.##......
.#..#######
.#...######
.##........
...###....#
...###....#
.##........
.#...######
.#..#######
.#.##......
..#...#####
.....##..##
.#..###..##
#...#.####.
....##.##.#

...##.#..#.##
.#..#.####.#.
###..........
..#.#..##..#.
.##..#.##.#..
#####......##
#.#####..####
###.##.##.##.
..#.########.
####........#
.###........#
..#.########.
###.##.##.##.
#.#####..####
#####......##
.##..#.##.#..
..#.#..##..#.

.......#.
.##..##.#
####.....
####..###
....##.#.
.##..###.
#..#.##.#
####.####
#..##....
.##.#..#.
.##.#..#.
#..##....
####.####
#..#.##.#
.##..#.#.

.##...##.
##.######
##.######
..#...##.
#..###..#
..#..####
#.####..#
#.....##.
....#.##.
.....#..#
#.##.#..#

.#.##.###
.#.##.###
..###.###
#..###..#
#.......#
.###..#..
##....##.
#..##.#..
#..##.#..
##....##.
..##..#..

##...###...#.####
###..#.##.#.#..#.
..#..##.##...##..
..#..##.##...##..
###..#.##.#.#..#.
##...###...#.####
##.##..#...###.#.
.#.#....#...#..##
..####..#.#.###..
#..##.#.##......#
#..##.#.##......#
..####..#.#.###..
.#.#....#...#.###
##.##..#...###.#.
##...###...#.####
###..#.##.#.#..#.
..#..##.##...##..

....##.....#.#...
......#.#.##....#
..........###.#..
....##...#.####..
#..##.#######.#..
...#..##.#####.#.
.....#..###..###.
####....#..#.....
....#.#.##.#..#.#
####.#..#.###..##
####...####.....#
#..#..##...##.###
#..#.#.....#.#...
#..##...#.###..##
#..##...#.###..##

...#.######
..##.##...#
..#.#.#..#.
###.#.#.#.#
...##....#.
##.#.##....
##...##....

.##.###
.#..##.
#.#.##.
.#.#..#
.#.#..#
#.#.##.
.#.###.
.#.###.
#.#.##.
.#.#..#
.#.#..#
#.#.##.
.#..##.

########.
..##..#..
.#..#.###
.#..#.#.#
..##..#..
########.
.####.###
........#
..##...##
#.##.##..
........#
##..##.#.
#....####
#....#..#
..##..#..

..####...#....#..
..#..#...##..##..
##....#####..####
#..##..#.#....#.#
...##...#.####.#.
.#....#.##.##.##.
##...###..#..#..#
##....##........#
.######.#..##..#.
##....###.####.##
.##..##..#....#..
###..###...##...#
#.####.#..####..#
#.#..#.#.##..##.#
##....##.#....#.#
.#....#..##..##..
#..##..#.#....#.#

.#..#.#...##.
.#..#.#...#..
##..######...
#....#..#..##
##..##.#.##..
#.##.######.#
##..####.#.#.
.#..#.#.#####
.####.#...#.#
##..##..##..#
#....##.#.##.
.#..#....###.
......##...##
.####.##.#.#.
......#.#...#

...##..
#.####.
.######
#.#..#.
#.#..#.
.######
#.####.
...##..
#.#....
#.####.
...##..

#..#.#...###..#
#.##.#........#
...###..#.#....
...###..#.#....
#.##.#........#
#..#.##..###..#
..##.##...####.
....##.#.#..#..
###...#....####
#...#.#.##.#..#
...##.##..#####
#.#.#####.###.#
..#####.######.
..#####.######.
#.#.#####.###.#

##.##.#
..##.#.
###.#..
..##..#
...####
##.#.##
..####.
..####.
##.#..#
...####
..##..#

..#########
##.##....##
....##..##.
##.##....##
##.#......#
#.##.####.#
.....####..
##..##..##.
..#.##..##.

##..###..
..#.##.#.
#....#...
##.#..#..
..####.##
####.##..
##.##.##.
##.....##
..####.#.
###..#.#.
##.#.#.##
....#..#.
....#...#
....#...#
....#..#.

#...#.####.#...
#....#...#.#.##
.#..####.#..###
..####...#..###
.....#.#....#.#
#..####.#.#.##.
#..####.#.#.##.
.....#.#....#..
..####...#..###
.#..####.#..###
#....#...#.#.##
#...#.####.#...
.####.#..#.##..
####..#.##.##.#
#.#.#..####..#.
#.#.#..####..#.
####..#.##.##.#

##.#..#.###
..######...
#.#.##.###.
#.##..##.##
...####...#
#..####..#.
#..####..#.

....#..####....
####..###......
....##.##..####
........####..#
.##.#.#.#.##..#
..#.#.#..#..##.
#########..####
#..#######.####
####....###.##.

#####..#####.
.##......##.#
..########...
...######....
#####..#####.
#.###..###.##
#.###..###.##
#####..#####.
...######....
..########...
.##......##.#
#####..#####.
.#.#.##.###..
.....##.....#
##........##.

#.##.##.##.##
#..#.##.#..##
...##..##....
#.#......#.##
.###.#..###..
..##.##.##...
#..#....#..##
##.######.###
#..######..##
####....#####
#..##..##..##
..#......#...
#.#......#.##
#....##....##
####.##.#####

##..#....##.#.#
##..#....##.#.#
...##..###.####
..###.#..###.#.
#.##.#.#####..#
#.#####.###.#..
##....###...##.
#..###.#...##..
##.###.#.....#.
#.#.#.#.#.##..#
..#..##.#..###.
..##.##.#.....#
#.##.##.#.....#

..#.#...##.
##.#.##.##.
##.##.##..#
..#..##.##.
##.#.###.##
..#.#..#..#
..###..#..#
..###.##..#
##....#####
##..##.....
..#..#.#..#

#..###.##.#.#...#
#.##.....#.###.#.
#.##..#.###.#.#.#
##........#..###.
#..##.#.###..#.#.
#..#.#...#....##.
#..#.#...#....##.
#..##.#.###..#.#.
##........#..###.
#.##..#.###.#.#.#
#.##.....#.###.#.
#..###.##...#...#
.##...##..#..##..
####.#...#...##..
..##.#..#..#.#.#.
##.##.#.#..#.#..#
##.##.#.#..#.#..#";

int Compare(string first, string second)
{
    if(first.Length != second.Length) throw new Exception("Not possible");

    var errors = 0;
    for (var i = 0; i < first.Length; i++)
    {
        if(first[i] != second[i]) errors++;
    }

    return errors;
}

int Search(List<string> pattern, int tolerance)
{
    var oddCorrection = pattern.Count % 2;

    // check first
    var firstLine = pattern[0];

    foreach (var match in Enumerable.Range(1, pattern.Count - oddCorrection).Where(i => i % 2 != 0))
    {
        var errors = Compare(pattern[match], firstLine);

        if (errors > tolerance) continue;

        var left = 1;
        var right = match - 1;
        for (; left < right; left++, right--)
        {
            errors += Compare(pattern[left], pattern[right]);
            if (errors > tolerance) 
            {
                break;
            }
        }
        
        if (errors == tolerance) return left;
    }

    // check last
    var lastLine = pattern[^1];

    foreach (var match in Enumerable.Range(oddCorrection, pattern.Count - 2).Where(i => i % 2 != 0))
    {
        var errors = Compare(pattern[match], lastLine);

        if (errors > tolerance) continue;

        var left = match + 1;
        var right = pattern.Count - 2;
        for (; left < right; left++, right--)
        {
            errors += Compare(pattern[left], pattern[right]);
            if (errors > tolerance) 
            {
                break;
            }
        }
        
        if (errors == tolerance) return left;
    }

    return -1;
}

int FindReflection(List<string> pattern, int tolerance)
{
    // search horizontal
    var hor = Search(pattern, tolerance);

    if (hor > -1) return hor * 100;

    // flip
    var verticalPattern = new List<string>();
    for(var i = 0; i < pattern[0].Length; i++)
    {
        verticalPattern.Add(new string(pattern.Select(l => l[i]).ToArray()));
    }

    // search vertical
    var ver = Search(verticalPattern, tolerance);

    if (ver > -1) return ver;

    throw new Exception("What!?");
}

void Run(string input, int tolerance)
{
    var sw = Stopwatch.StartNew();

    using var sr = new StringReader(input);
    string line;

    var sum = 0;
    var i = 0;
    while ((line = sr.ReadLine()) != null)
    {
        var pattern = new List<string>();
        do
        {
            pattern.Add(line);
        }while(!string.IsNullOrEmpty(line = sr.ReadLine()));

        var val = FindReflection(pattern, tolerance);

        Console.WriteLine($"Pattern #{++i}: {val}");

        sum += val;
    }

    Console.WriteLine($"Sum: {sum}");

    sw.Stop();
    Console.WriteLine($"============= {sw.ElapsedMilliseconds}ms =============");
}


Console.WriteLine("Part 1:");
Run(INPUT1, 0);
Run(INPUT2, 0);

Console.WriteLine("Part 2:");
Run(INPUT1, 1);
Run(INPUT2, 1);
